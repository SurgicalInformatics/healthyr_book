<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>HealthyR: R for healthcare data analysis</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="A HealthyR texbook for our 2.5-day quickstart training course.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="HealthyR: R for healthcare data analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/healthyr_book_cover.png" />
  <meta property="og:description" content="A HealthyR texbook for our 2.5-day quickstart training course." />
  <meta name="github-repo" content="SurgicalInformatics/healthyr_book/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="HealthyR: R for healthcare data analysis" />
  
  <meta name="twitter:description" content="A HealthyR texbook for our 2.5-day quickstart training course." />
  <meta name="twitter:image" content="images/healthyr_book_cover.png" />

<meta name="author" content="Riinu Ots and Ewen Harrison">


<meta name="date" content="2018-04-24">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="if-you-are-new-to-linear-regression.html">
<link rel="next" href="very-advanced-example.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for healthcare data analysis</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a><ul>
<li class="chapter" data-level="0.1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>0.1</b> Installation</a></li>
</ul></li>
<li class="part"><span><b>I Always plot your data first</b></span></li>
<li class="chapter" data-level="1" data-path="your-first-r-plots.html"><a href="your-first-r-plots.html"><i class="fa fa-check"></i><b>1</b> Your first R plots</a><ul>
<li class="chapter" data-level="1.1" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>1.1</b> Data</a></li>
<li class="chapter" data-level="1.2" data-path="first-plot.html"><a href="first-plot.html"><i class="fa fa-check"></i><b>1.2</b> First plot</a><ul>
<li class="chapter" data-level="1.2.1" data-path="first-plot.html"><a href="first-plot.html#question"><i class="fa fa-check"></i><b>1.2.1</b> Question</a></li>
<li class="chapter" data-level="1.2.2" data-path="first-plot.html"><a href="first-plot.html#exercise"><i class="fa fa-check"></i><b>1.2.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="comparing-bars-of-different-height.html"><a href="comparing-bars-of-different-height.html"><i class="fa fa-check"></i><b>1.3</b> Comparing bars of different height</a><ul>
<li class="chapter" data-level="1.3.1" data-path="comparing-bars-of-different-height.html"><a href="comparing-bars-of-different-height.html#stretch-each-bar-to-100"><i class="fa fa-check"></i><b>1.3.1</b> Stretch each bar to 100%</a></li>
<li class="chapter" data-level="1.3.2" data-path="comparing-bars-of-different-height.html"><a href="comparing-bars-of-different-height.html#plot-each-bar-next-to-each-other"><i class="fa fa-check"></i><b>1.3.2</b> Plot each bar next to each other</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="facets-panels.html"><a href="facets-panels.html"><i class="fa fa-check"></i><b>1.4</b> Facets (panels)</a></li>
<li class="chapter" data-level="1.5" data-path="extra-using-aethetics-outside-of-the-aes.html"><a href="extra-using-aethetics-outside-of-the-aes.html"><i class="fa fa-check"></i><b>1.5</b> Extra: using aethetics outside of the aes()</a><ul>
<li class="chapter" data-level="1.5.1" data-path="extra-using-aethetics-outside-of-the-aes.html"><a href="extra-using-aethetics-outside-of-the-aes.html#setting-a-constant-fill"><i class="fa fa-check"></i><b>1.5.1</b> Setting a constant fill</a></li>
<li class="chapter" data-level="1.5.2" data-path="extra-using-aethetics-outside-of-the-aes.html"><a href="extra-using-aethetics-outside-of-the-aes.html#exercise-1"><i class="fa fa-check"></i><b>1.5.2</b> Exercise</a></li>
<li class="chapter" data-level="1.5.3" data-path="extra-using-aethetics-outside-of-the-aes.html"><a href="extra-using-aethetics-outside-of-the-aes.html#exercise-2"><i class="fa fa-check"></i><b>1.5.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="two-geoms-for-barplots-geom-bar-or-geom-col.html"><a href="two-geoms-for-barplots-geom-bar-or-geom-col.html"><i class="fa fa-check"></i><b>1.6</b> Two geoms for barplots: <code>geom_bar()</code> or <code>geom_col()</code></a></li>
<li class="chapter" data-level="1.7" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>1.7</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>2</b> R Basics</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-help.html"><a href="getting-help.html"><i class="fa fa-check"></i><b>2.1</b> Getting help</a></li>
<li class="chapter" data-level="2.2" data-path="starting-with-a-blank-canvas.html"><a href="starting-with-a-blank-canvas.html"><i class="fa fa-check"></i><b>2.2</b> Starting with a blank canvas</a></li>
<li class="chapter" data-level="2.3" data-path="working-with-objects.html"><a href="working-with-objects.html"><i class="fa fa-check"></i><b>2.3</b> Working with Objects</a><ul>
<li class="chapter" data-level="2.3.1" data-path="working-with-objects.html"><a href="working-with-objects.html#exercise-3"><i class="fa fa-check"></i><b>2.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="loading-data.html"><a href="loading-data.html"><i class="fa fa-check"></i><b>2.4</b> Loading data</a><ul>
<li class="chapter" data-level="2.4.1" data-path="loading-data.html"><a href="loading-data.html#excercise"><i class="fa fa-check"></i><b>2.4.1</b> Excercise</a></li>
<li class="chapter" data-level="2.4.2" data-path="loading-data.html"><a href="loading-data.html#other-ways-to-investigate-objects"><i class="fa fa-check"></i><b>2.4.2</b> Other ways to investigate objects</a></li>
<li class="chapter" data-level="2.4.3" data-path="loading-data.html"><a href="loading-data.html#exercise-4"><i class="fa fa-check"></i><b>2.4.3</b> Exercise</a></li>
<li class="chapter" data-level="2.4.4" data-path="loading-data.html"><a href="loading-data.html#exercise-5"><i class="fa fa-check"></i><b>2.4.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="operators.html"><a href="operators.html"><i class="fa fa-check"></i><b>2.5</b> Operators</a><ul>
<li class="chapter" data-level="2.5.1" data-path="operators.html"><a href="operators.html#exercise-6"><i class="fa fa-check"></i><b>2.5.1</b> Exercise</a></li>
<li class="chapter" data-level="2.5.2" data-path="operators.html"><a href="operators.html#exercise-7"><i class="fa fa-check"></i><b>2.5.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="types-of-variables.html"><a href="types-of-variables.html"><i class="fa fa-check"></i><b>2.6</b> Types of variables</a><ul>
<li class="chapter" data-level="2.6.1" data-path="types-of-variables.html"><a href="types-of-variables.html#characters"><i class="fa fa-check"></i><b>2.6.1</b> Characters</a></li>
<li class="chapter" data-level="2.6.2" data-path="types-of-variables.html"><a href="types-of-variables.html#factors"><i class="fa fa-check"></i><b>2.6.2</b> Factors</a></li>
<li class="chapter" data-level="2.6.3" data-path="types-of-variables.html"><a href="types-of-variables.html#numbers"><i class="fa fa-check"></i><b>2.6.3</b> Numbers</a></li>
<li class="chapter" data-level="2.6.4" data-path="types-of-variables.html"><a href="types-of-variables.html#specifying-variable-types"><i class="fa fa-check"></i><b>2.6.4</b> Specifying variable types</a></li>
<li class="chapter" data-level="2.6.5" data-path="types-of-variables.html"><a href="types-of-variables.html#exercise-9"><i class="fa fa-check"></i><b>2.6.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>2.7</b> Importing data</a></li>
<li class="chapter" data-level="2.8" data-path="adding-columns-to-dataframes.html"><a href="adding-columns-to-dataframes.html"><i class="fa fa-check"></i><b>2.8</b> Adding columns to dataframes</a></li>
<li class="chapter" data-level="2.9" data-path="rounding-numbers.html"><a href="rounding-numbers.html"><i class="fa fa-check"></i><b>2.9</b> Rounding numbers</a><ul>
<li class="chapter" data-level="2.9.1" data-path="rounding-numbers.html"><a href="rounding-numbers.html#exercise-10"><i class="fa fa-check"></i><b>2.9.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="the-combine-function-c.html"><a href="the-combine-function-c.html"><i class="fa fa-check"></i><b>2.10</b> The combine function: c()</a><ul>
<li class="chapter" data-level="2.10.1" data-path="the-combine-function-c.html"><a href="the-combine-function-c.html#exercise-11"><i class="fa fa-check"></i><b>2.10.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="the-paste-function.html"><a href="the-paste-function.html"><i class="fa fa-check"></i><b>2.11</b> The <code>paste()</code> function</a><ul>
<li class="chapter" data-level="2.11.1" data-path="the-paste-function.html"><a href="the-paste-function.html#exercise-12"><i class="fa fa-check"></i><b>2.11.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="combining-two-dataframes.html"><a href="combining-two-dataframes.html"><i class="fa fa-check"></i><b>2.12</b> Combining two dataframes</a><ul>
<li class="chapter" data-level="2.12.1" data-path="combining-two-dataframes.html"><a href="combining-two-dataframes.html#exercise-13"><i class="fa fa-check"></i><b>2.12.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="the-summary-function.html"><a href="the-summary-function.html"><i class="fa fa-check"></i><b>2.13</b> The <code>summary()</code> Function</a><ul>
<li class="chapter" data-level="2.13.1" data-path="the-summary-function.html"><a href="the-summary-function.html#when-pipe-sends-data-to-the-wrong-place"><i class="fa fa-check"></i><b>2.13.1</b> When pipe sends data to the wrong place</a></li>
<li class="chapter" data-level="2.13.2" data-path="the-summary-function.html"><a href="the-summary-function.html#exercise-14"><i class="fa fa-check"></i><b>2.13.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="extra-creating-a-dataframe-from-scratch.html"><a href="extra-creating-a-dataframe-from-scratch.html"><i class="fa fa-check"></i><b>2.14</b> Extra: Creating a dataframe from scratch</a><ul>
<li class="chapter" data-level="2.14.1" data-path="extra-creating-a-dataframe-from-scratch.html"><a href="extra-creating-a-dataframe-from-scratch.html#exercise-15"><i class="fa fa-check"></i><b>2.14.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.15" data-path="solutions-1.html"><a href="solutions-1.html"><i class="fa fa-check"></i><b>2.15</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="summarising-data.html"><a href="summarising-data.html"><i class="fa fa-check"></i><b>3</b> Summarising data</a><ul>
<li class="chapter" data-level="3.1" data-path="data-1.html"><a href="data-1.html"><i class="fa fa-check"></i><b>3.1</b> Data</a></li>
<li class="chapter" data-level="3.2" data-path="tidyverse-packages-ggplot2-dplyr-tidyr-etc-.html"><a href="tidyverse-packages-ggplot2-dplyr-tidyr-etc-.html"><i class="fa fa-check"></i><b>3.2</b> Tidyverse packages: ggplot2, dplyr, tidyr, etc.</a></li>
<li class="chapter" data-level="3.3" data-path="basic-functions-for-summarising-data.html"><a href="basic-functions-for-summarising-data.html"><i class="fa fa-check"></i><b>3.3</b> Basic functions for summarising data</a></li>
<li class="chapter" data-level="3.4" data-path="subgroup-analysis-group-by-and-summarise.html"><a href="subgroup-analysis-group-by-and-summarise.html"><i class="fa fa-check"></i><b>3.4</b> Subgroup analysis: <code>group_by()</code> and <code>summarise()</code></a><ul>
<li class="chapter" data-level="3.4.1" data-path="subgroup-analysis-group-by-and-summarise.html"><a href="subgroup-analysis-group-by-and-summarise.html#exercise-16"><i class="fa fa-check"></i><b>3.4.1</b> Exercise</a></li>
<li class="chapter" data-level="3.4.2" data-path="subgroup-analysis-group-by-and-summarise.html"><a href="subgroup-analysis-group-by-and-summarise.html#exercise-17"><i class="fa fa-check"></i><b>3.4.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="mutate.html"><a href="mutate.html"><i class="fa fa-check"></i><b>3.5</b> <code>mutate()</code></a><ul>
<li class="chapter" data-level="3.5.1" data-path="mutate.html"><a href="mutate.html#exercise-18"><i class="fa fa-check"></i><b>3.5.1</b> Exercise</a></li>
<li class="chapter" data-level="3.5.2" data-path="mutate.html"><a href="mutate.html#optional-advanced-exercise"><i class="fa fa-check"></i><b>3.5.2</b> Optional advanced exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="wide-vs-long-spread-and-gather.html"><a href="wide-vs-long-spread-and-gather.html"><i class="fa fa-check"></i><b>3.6</b> Wide vs long: <code>spread()</code> and <code>gather()</code></a><ul>
<li class="chapter" data-level="3.6.1" data-path="wide-vs-long-spread-and-gather.html"><a href="wide-vs-long-spread-and-gather.html#wide-format"><i class="fa fa-check"></i><b>3.6.1</b> Wide format</a></li>
<li class="chapter" data-level="3.6.2" data-path="wide-vs-long-spread-and-gather.html"><a href="wide-vs-long-spread-and-gather.html#exercise-19"><i class="fa fa-check"></i><b>3.6.2</b> Exercise</a></li>
<li class="chapter" data-level="3.6.3" data-path="wide-vs-long-spread-and-gather.html"><a href="wide-vs-long-spread-and-gather.html#long-format"><i class="fa fa-check"></i><b>3.6.3</b> Long format</a></li>
<li class="chapter" data-level="3.6.4" data-path="wide-vs-long-spread-and-gather.html"><a href="wide-vs-long-spread-and-gather.html#exercise-20"><i class="fa fa-check"></i><b>3.6.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="sorting-arrange.html"><a href="sorting-arrange.html"><i class="fa fa-check"></i><b>3.7</b> Sorting: <code>arrange()</code></a></li>
<li class="chapter" data-level="3.8" data-path="factor-handling.html"><a href="factor-handling.html"><i class="fa fa-check"></i><b>3.8</b> Factor handling</a><ul>
<li class="chapter" data-level="3.8.1" data-path="factor-handling.html"><a href="factor-handling.html#exercise-21"><i class="fa fa-check"></i><b>3.8.1</b> Exercise</a></li>
<li class="chapter" data-level="3.8.2" data-path="factor-handling.html"><a href="factor-handling.html#fct_collapse---grouping-levels-together"><i class="fa fa-check"></i><b>3.8.2</b> <code>fct_collapse()</code> - grouping levels together</a></li>
<li class="chapter" data-level="3.8.3" data-path="factor-handling.html"><a href="factor-handling.html#fct_relevel---change-the-order-of-levels"><i class="fa fa-check"></i><b>3.8.3</b> <code>fct_relevel()</code> - change the order of levels</a></li>
<li class="chapter" data-level="3.8.4" data-path="factor-handling.html"><a href="factor-handling.html#fct_recode---rename-levels"><i class="fa fa-check"></i><b>3.8.4</b> <code>fct_recode()</code> - rename levels</a></li>
<li class="chapter" data-level="3.8.5" data-path="factor-handling.html"><a href="factor-handling.html#converting-factors-to-numbers"><i class="fa fa-check"></i><b>3.8.5</b> Converting factors to numbers</a></li>
<li class="chapter" data-level="3.8.6" data-path="factor-handling.html"><a href="factor-handling.html#exercise-22"><i class="fa fa-check"></i><b>3.8.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="long-exercise.html"><a href="long-exercise.html"><i class="fa fa-check"></i><b>3.9</b> Long Exercise</a></li>
<li class="chapter" data-level="3.10" data-path="extra-formatting-a-table-for-publication.html"><a href="extra-formatting-a-table-for-publication.html"><i class="fa fa-check"></i><b>3.10</b> Extra: formatting a table for publication</a></li>
<li class="chapter" data-level="3.11" data-path="solution-long-exercise.html"><a href="solution-long-exercise.html"><i class="fa fa-check"></i><b>3.11</b> Solution: Long Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="different-types-of-plots.html"><a href="different-types-of-plots.html"><i class="fa fa-check"></i><b>4</b> Different types of plots</a><ul>
<li class="chapter" data-level="4.1" data-path="data-2.html"><a href="data-2.html"><i class="fa fa-check"></i><b>4.1</b> Data</a></li>
<li class="chapter" data-level="4.2" data-path="scatter-plotsbubble-plots-geom-point.html"><a href="scatter-plotsbubble-plots-geom-point.html"><i class="fa fa-check"></i><b>4.2</b> Scatter plots/bubble plots - <code>geom_point()</code></a><ul>
<li class="chapter" data-level="4.2.1" data-path="scatter-plotsbubble-plots-geom-point.html"><a href="scatter-plotsbubble-plots-geom-point.html#exercise-23"><i class="fa fa-check"></i><b>4.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="line-charttimeplot-geom-line.html"><a href="line-charttimeplot-geom-line.html"><i class="fa fa-check"></i><b>4.3</b> Line chart/timeplot - <code>geom_line()</code></a><ul>
<li class="chapter" data-level="4.3.1" data-path="line-charttimeplot-geom-line.html"><a href="line-charttimeplot-geom-line.html#exercise-24"><i class="fa fa-check"></i><b>4.3.1</b> Exercise</a></li>
<li class="chapter" data-level="4.3.2" data-path="line-charttimeplot-geom-line.html"><a href="line-charttimeplot-geom-line.html#advanced-example"><i class="fa fa-check"></i><b>4.3.2</b> Advanced example</a></li>
<li class="chapter" data-level="4.3.3" data-path="line-charttimeplot-geom-line.html"><a href="line-charttimeplot-geom-line.html#advanced-exercise"><i class="fa fa-check"></i><b>4.3.3</b> Advanced Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="box-plot-geom-boxplot.html"><a href="box-plot-geom-boxplot.html"><i class="fa fa-check"></i><b>4.4</b> Box-plot - <code>geom_boxplot()</code></a><ul>
<li class="chapter" data-level="4.4.1" data-path="box-plot-geom-boxplot.html"><a href="box-plot-geom-boxplot.html#exercise-25"><i class="fa fa-check"></i><b>4.4.1</b> Exercise</a></li>
<li class="chapter" data-level="4.4.2" data-path="box-plot-geom-boxplot.html"><a href="box-plot-geom-boxplot.html#dot-plot---geom_dotplot"><i class="fa fa-check"></i><b>4.4.2</b> Dot-plot - <code>geom_dotplot()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="barplot-geom-bar-and-geom-col.html"><a href="barplot-geom-bar-and-geom-col.html"><i class="fa fa-check"></i><b>4.5</b> Barplot - <code>geom_bar()</code> and <code>geom_col()</code></a><ul>
<li class="chapter" data-level="4.5.1" data-path="barplot-geom-bar-and-geom-col.html"><a href="barplot-geom-bar-and-geom-col.html#exercise-26"><i class="fa fa-check"></i><b>4.5.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="all-other-types-of-plots.html"><a href="all-other-types-of-plots.html"><i class="fa fa-check"></i><b>4.6</b> All other types of plots</a></li>
<li class="chapter" data-level="4.7" data-path="specifying-aes-variables.html"><a href="specifying-aes-variables.html"><i class="fa fa-check"></i><b>4.7</b> Specifying <code>aes()</code> variables</a></li>
<li class="chapter" data-level="4.8" data-path="extra-optional-exercises.html"><a href="extra-optional-exercises.html"><i class="fa fa-check"></i><b>4.8</b> Extra: Optional exercises</a><ul>
<li class="chapter" data-level="4.8.1" data-path="extra-optional-exercises.html"><a href="extra-optional-exercises.html#exercise-27"><i class="fa fa-check"></i><b>4.8.1</b> Exercise</a></li>
<li class="chapter" data-level="4.8.2" data-path="extra-optional-exercises.html"><a href="extra-optional-exercises.html#exercise-28"><i class="fa fa-check"></i><b>4.8.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="solutions-2.html"><a href="solutions-2.html"><i class="fa fa-check"></i><b>4.9</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="fine-tuning-plots.html"><a href="fine-tuning-plots.html"><i class="fa fa-check"></i><b>5</b> Fine tuning plots</a><ul>
<li class="chapter" data-level="5.1" data-path="data-and-initial-plot.html"><a href="data-and-initial-plot.html"><i class="fa fa-check"></i><b>5.1</b> Data and initial plot</a></li>
<li class="chapter" data-level="5.2" data-path="scales.html"><a href="scales.html"><i class="fa fa-check"></i><b>5.2</b> Scales</a><ul>
<li class="chapter" data-level="5.2.1" data-path="scales.html"><a href="scales.html#logarithmic"><i class="fa fa-check"></i><b>5.2.1</b> Logarithmic</a></li>
<li class="chapter" data-level="5.2.2" data-path="scales.html"><a href="scales.html#expand-limits"><i class="fa fa-check"></i><b>5.2.2</b> Expand limits</a></li>
<li class="chapter" data-level="5.2.3" data-path="scales.html"><a href="scales.html#zoom-in"><i class="fa fa-check"></i><b>5.2.3</b> Zoom in</a></li>
<li class="chapter" data-level="5.2.4" data-path="scales.html"><a href="scales.html#exercise-29"><i class="fa fa-check"></i><b>5.2.4</b> Exercise</a></li>
<li class="chapter" data-level="5.2.5" data-path="scales.html"><a href="scales.html#axis-ticks"><i class="fa fa-check"></i><b>5.2.5</b> Axis ticks</a></li>
<li class="chapter" data-level="5.2.6" data-path="scales.html"><a href="scales.html#swap-the-axes"><i class="fa fa-check"></i><b>5.2.6</b> Swap the axes</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="colours.html"><a href="colours.html"><i class="fa fa-check"></i><b>5.3</b> Colours</a><ul>
<li class="chapter" data-level="5.3.1" data-path="colours.html"><a href="colours.html#using-the-brewer-palettes"><i class="fa fa-check"></i><b>5.3.1</b> Using the Brewer palettes:</a></li>
<li class="chapter" data-level="5.3.2" data-path="colours.html"><a href="colours.html#legend-title"><i class="fa fa-check"></i><b>5.3.2</b> Legend title</a></li>
<li class="chapter" data-level="5.3.3" data-path="colours.html"><a href="colours.html#choosing-colours-manually"><i class="fa fa-check"></i><b>5.3.3</b> Choosing colours manually</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="titles-and-labels.html"><a href="titles-and-labels.html"><i class="fa fa-check"></i><b>5.4</b> Titles and labels</a><ul>
<li class="chapter" data-level="5.4.1" data-path="titles-and-labels.html"><a href="titles-and-labels.html#annotation"><i class="fa fa-check"></i><b>5.4.1</b> Annotation</a></li>
<li class="chapter" data-level="5.4.2" data-path="titles-and-labels.html"><a href="titles-and-labels.html#annotation-with-a-superscript-and-a-variable"><i class="fa fa-check"></i><b>5.4.2</b> Annotation with a superscript and a variable</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="text-size.html"><a href="text-size.html"><i class="fa fa-check"></i><b>5.5</b> Text size</a><ul>
<li class="chapter" data-level="5.5.1" data-path="text-size.html"><a href="text-size.html#legend-position"><i class="fa fa-check"></i><b>5.5.1</b> Legend position</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="saving-your-plot.html"><a href="saving-your-plot.html"><i class="fa fa-check"></i><b>5.6</b> Saving your plot</a></li>
</ul></li>
<li class="part"><span><b>II Medical Statistics</b></span></li>
<li class="chapter" data-level="6" data-path="tests-for-continuous-outcome-variables.html"><a href="tests-for-continuous-outcome-variables.html"><i class="fa fa-check"></i><b>6</b> Tests for continuous outcome variables</a><ul>
<li class="chapter" data-level="6.1" data-path="load-data.html"><a href="load-data.html"><i class="fa fa-check"></i><b>6.1</b> Load data</a></li>
<li class="chapter" data-level="6.2" data-path="t-test.html"><a href="t-test.html"><i class="fa fa-check"></i><b>6.2</b> T-test</a><ul>
<li class="chapter" data-level="6.2.1" data-path="t-test.html"><a href="t-test.html#plotting"><i class="fa fa-check"></i><b>6.2.1</b> Plotting</a></li>
<li class="chapter" data-level="6.2.2" data-path="t-test.html"><a href="t-test.html#histogram-for-each-continent"><i class="fa fa-check"></i><b>6.2.2</b> Histogram for each continent</a></li>
<li class="chapter" data-level="6.2.3" data-path="t-test.html"><a href="t-test.html#q-q-plot-for-each-continent"><i class="fa fa-check"></i><b>6.2.3</b> Q-Q plot for each continent</a></li>
<li class="chapter" data-level="6.2.4" data-path="t-test.html"><a href="t-test.html#boxplot-of-2-years"><i class="fa fa-check"></i><b>6.2.4</b> Boxplot of 2 years</a></li>
<li class="chapter" data-level="6.2.5" data-path="t-test.html"><a href="t-test.html#exercise-30"><i class="fa fa-check"></i><b>6.2.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="two-sample-t-tests.html"><a href="two-sample-t-tests.html"><i class="fa fa-check"></i><b>6.3</b> Two-sample t-tests</a><ul>
<li class="chapter" data-level="6.3.1" data-path="two-sample-t-tests.html"><a href="two-sample-t-tests.html#t-test-output"><i class="fa fa-check"></i><b>6.3.1</b> T-Test output</a></li>
<li class="chapter" data-level="6.3.2" data-path="two-sample-t-tests.html"><a href="two-sample-t-tests.html#exercise-31"><i class="fa fa-check"></i><b>6.3.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="one-sample-t-tests.html"><a href="one-sample-t-tests.html"><i class="fa fa-check"></i><b>6.4</b> One sample t-tests</a><ul>
<li class="chapter" data-level="6.4.1" data-path="one-sample-t-tests.html"><a href="one-sample-t-tests.html#exercise-32"><i class="fa fa-check"></i><b>6.4.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>6.5</b> ANOVA</a><ul>
<li class="chapter" data-level="6.5.1" data-path="anova.html"><a href="anova.html#plotting-1"><i class="fa fa-check"></i><b>6.5.1</b> Plotting</a></li>
<li class="chapter" data-level="6.5.2" data-path="anova.html"><a href="anova.html#analysis"><i class="fa fa-check"></i><b>6.5.2</b> Analysis</a></li>
<li class="chapter" data-level="6.5.3" data-path="anova.html"><a href="anova.html#check-assumptions"><i class="fa fa-check"></i><b>6.5.3</b> Check assumptions</a></li>
<li class="chapter" data-level="6.5.4" data-path="anova.html"><a href="anova.html#perform-pairwise-tests"><i class="fa fa-check"></i><b>6.5.4</b> Perform pairwise tests</a></li>
<li class="chapter" data-level="6.5.5" data-path="anova.html"><a href="anova.html#top-tip-the-cut-function"><i class="fa fa-check"></i><b>6.5.5</b> Top tip: the cut() function</a></li>
<li class="chapter" data-level="6.5.6" data-path="anova.html"><a href="anova.html#exercise-33"><i class="fa fa-check"></i><b>6.5.6</b> Exercise</a></li>
<li class="chapter" data-level="6.5.7" data-path="anova.html"><a href="anova.html#exercise-34"><i class="fa fa-check"></i><b>6.5.7</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="non-parametric-data.html"><a href="non-parametric-data.html"><i class="fa fa-check"></i><b>6.6</b> Non-parametric data</a><ul>
<li class="chapter" data-level="6.6.1" data-path="non-parametric-data.html"><a href="non-parametric-data.html#plotting-2"><i class="fa fa-check"></i><b>6.6.1</b> Plotting</a></li>
<li class="chapter" data-level="6.6.2" data-path="non-parametric-data.html"><a href="non-parametric-data.html#exercise-non-parametric-testing"><i class="fa fa-check"></i><b>6.6.2</b> Exercise: Non-parametric testing</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="solutions-3.html"><a href="solutions-3.html"><i class="fa fa-check"></i><b>6.7</b> Solutions</a></li>
<li class="chapter" data-level="6.8" data-path="advanced-example-1.html"><a href="advanced-example-1.html"><i class="fa fa-check"></i><b>6.8</b> Advanced example</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>7</b> Linear regression</a><ul>
<li class="chapter" data-level="7.1" data-path="data-3.html"><a href="data-3.html"><i class="fa fa-check"></i><b>7.1</b> Data</a></li>
<li class="chapter" data-level="7.2" data-path="plotting-3.html"><a href="plotting-3.html"><i class="fa fa-check"></i><b>7.2</b> Plotting</a><ul>
<li class="chapter" data-level="7.2.1" data-path="plotting-3.html"><a href="plotting-3.html#exercise-35"><i class="fa fa-check"></i><b>7.2.1</b> Exercise</a></li>
<li class="chapter" data-level="7.2.2" data-path="plotting-3.html"><a href="plotting-3.html#exercise-36"><i class="fa fa-check"></i><b>7.2.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>7.3</b> Simple linear regression</a><ul>
<li class="chapter" data-level="7.3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercise-37"><i class="fa fa-check"></i><b>7.3.1</b> Exercise</a></li>
<li class="chapter" data-level="7.3.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#model-information-summary-tidy-glance"><i class="fa fa-check"></i><b>7.3.2</b> Model information: <code>summary()</code>, <code>tidy()</code> ,<code>glance()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="if-you-are-new-to-linear-regression.html"><a href="if-you-are-new-to-linear-regression.html"><i class="fa fa-check"></i><b>7.4</b> If you are new to linear regression</a><ul>
<li class="chapter" data-level="7.4.1" data-path="if-you-are-new-to-linear-regression.html"><a href="if-you-are-new-to-linear-regression.html#exercise---residuals"><i class="fa fa-check"></i><b>7.4.1</b> Exercise - Residuals</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>7.5</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="7.5.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#exercise-38"><i class="fa fa-check"></i><b>7.5.1</b> Exercise</a></li>
<li class="chapter" data-level="7.5.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#exercise-39"><i class="fa fa-check"></i><b>7.5.2</b> Exercise</a></li>
<li class="chapter" data-level="7.5.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#exercise-40"><i class="fa fa-check"></i><b>7.5.3</b> Exercise</a></li>
<li class="chapter" data-level="7.5.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#optional-advanced-exercise-1"><i class="fa fa-check"></i><b>7.5.4</b> Optional (Advanced) Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="very-advanced-example.html"><a href="very-advanced-example.html"><i class="fa fa-check"></i><b>7.6</b> Very advanced example</a></li>
<li class="chapter" data-level="7.7" data-path="solutions-4.html"><a href="solutions-4.html"><i class="fa fa-check"></i><b>7.7</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tests-for-categorical-variables.html"><a href="tests-for-categorical-variables.html"><i class="fa fa-check"></i><b>8</b> Tests for categorical variables</a><ul>
<li class="chapter" data-level="8.1" data-path="data-4.html"><a href="data-4.html"><i class="fa fa-check"></i><b>8.1</b> Data</a><ul>
<li class="chapter" data-level="8.1.1" data-path="data-4.html"><a href="data-4.html#recap-on-factors"><i class="fa fa-check"></i><b>8.1.1</b> Recap on factors</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="chi-squared-test-fishers-exact-test.html"><a href="chi-squared-test-fishers-exact-test.html"><i class="fa fa-check"></i><b>8.2</b> Chi-squared test / Fisher’s exact test</a><ul>
<li class="chapter" data-level="8.2.1" data-path="chi-squared-test-fishers-exact-test.html"><a href="chi-squared-test-fishers-exact-test.html#plotting-4"><i class="fa fa-check"></i><b>8.2.1</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="analysis-1.html"><a href="analysis-1.html"><i class="fa fa-check"></i><b>8.3</b> Analysis</a><ul>
<li class="chapter" data-level="8.3.1" data-path="analysis-1.html"><a href="analysis-1.html#using-base-r"><i class="fa fa-check"></i><b>8.3.1</b> Using base R</a></li>
<li class="chapter" data-level="8.3.2" data-path="analysis-1.html"><a href="analysis-1.html#using-crosstable"><i class="fa fa-check"></i><b>8.3.2</b> Using <code>CrossTable</code></a></li>
<li class="chapter" data-level="8.3.3" data-path="analysis-1.html"><a href="analysis-1.html#exercise-41"><i class="fa fa-check"></i><b>8.3.3</b> Exercise</a></li>
<li class="chapter" data-level="8.3.4" data-path="analysis-1.html"><a href="analysis-1.html#fishers-exact-test"><i class="fa fa-check"></i><b>8.3.4</b> Fisher’s exact test</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="summarising-multiple-factors-optional.html"><a href="summarising-multiple-factors-optional.html"><i class="fa fa-check"></i><b>8.4</b> Summarising multiple factors (optional)</a><ul>
<li class="chapter" data-level="8.4.1" data-path="summarising-multiple-factors-optional.html"><a href="summarising-multiple-factors-optional.html#summarising-factors-with-libraryhmisc"><i class="fa fa-check"></i><b>8.4.1</b> Summarising factors with <code>library(Hmisc)</code></a></li>
<li class="chapter" data-level="8.4.2" data-path="summarising-multiple-factors-optional.html"><a href="summarising-multiple-factors-optional.html#summarising-factors-with-librarytidyverse"><i class="fa fa-check"></i><b>8.4.2</b> Summarising factors with <code>library(tidyverse)</code></a></li>
<li class="chapter" data-level="8.4.3" data-path="summarising-multiple-factors-optional.html"><a href="summarising-multiple-factors-optional.html#example"><i class="fa fa-check"></i><b>8.4.3</b> Example</a></li>
<li class="chapter" data-level="8.4.4" data-path="summarising-multiple-factors-optional.html"><a href="summarising-multiple-factors-optional.html#exercise-42"><i class="fa fa-check"></i><b>8.4.4</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>9</b> Logistic regression</a><ul>
<li class="chapter" data-level="9.1" data-path="what-is-logistic-regression.html"><a href="what-is-logistic-regression.html"><i class="fa fa-check"></i><b>9.1</b> What is Logistic Regression?</a></li>
<li class="chapter" data-level="9.2" data-path="definitions.html"><a href="definitions.html"><i class="fa fa-check"></i><b>9.2</b> Definitions</a></li>
<li class="chapter" data-level="9.3" data-path="odds-and-probabilities.html"><a href="odds-and-probabilities.html"><i class="fa fa-check"></i><b>9.3</b> Odds and probabilities</a><ul>
<li class="chapter" data-level="9.3.1" data-path="odds-and-probabilities.html"><a href="odds-and-probabilities.html#odds-ratios"><i class="fa fa-check"></i><b>9.3.1</b> Odds ratios</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="melanoma-dataset.html"><a href="melanoma-dataset.html"><i class="fa fa-check"></i><b>9.4</b> Melanoma dataset</a><ul>
<li class="chapter" data-level="9.4.1" data-path="melanoma-dataset.html"><a href="melanoma-dataset.html#doing-logistic-regression-in-r"><i class="fa fa-check"></i><b>9.4.1</b> Doing logistic regression in R</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="setting-up-your-data.html"><a href="setting-up-your-data.html"><i class="fa fa-check"></i><b>9.5</b> Setting up your data</a><ul>
<li class="chapter" data-level="9.5.1" data-path="setting-up-your-data.html"><a href="setting-up-your-data.html#worked-example"><i class="fa fa-check"></i><b>9.5.1</b> Worked Example</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="creating-categories.html"><a href="creating-categories.html"><i class="fa fa-check"></i><b>9.6</b> Creating categories</a><ul>
<li class="chapter" data-level="9.6.1" data-path="creating-categories.html"><a href="creating-categories.html#exercise-43"><i class="fa fa-check"></i><b>9.6.1</b> Exercise</a></li>
<li class="chapter" data-level="9.6.2" data-path="creating-categories.html"><a href="creating-categories.html#always-plot-your-data-first"><i class="fa fa-check"></i><b>9.6.2</b> Always plot your data first!</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="basic-one-explanatory-variable-predictor.html"><a href="basic-one-explanatory-variable-predictor.html"><i class="fa fa-check"></i><b>9.7</b> Basic: One explanatory variable (predictor)</a><ul>
<li class="chapter" data-level="9.7.1" data-path="basic-one-explanatory-variable-predictor.html"><a href="basic-one-explanatory-variable-predictor.html#worked-example-1"><i class="fa fa-check"></i><b>9.7.1</b> Worked example</a></li>
<li class="chapter" data-level="9.7.2" data-path="basic-one-explanatory-variable-predictor.html"><a href="basic-one-explanatory-variable-predictor.html#exercise-44"><i class="fa fa-check"></i><b>9.7.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="summarizer-package.html"><a href="summarizer-package.html"><i class="fa fa-check"></i><b>9.8</b> Summarizer package</a></li>
<li class="chapter" data-level="9.9" data-path="summarise-a-list-of-variables-by-another-variable.html"><a href="summarise-a-list-of-variables-by-another-variable.html"><i class="fa fa-check"></i><b>9.9</b> Summarise a list of variables by another variable</a></li>
<li class="chapter" data-level="9.10" data-path="summarizer-function-for-logistic-regression.html"><a href="summarizer-function-for-logistic-regression.html"><i class="fa fa-check"></i><b>9.10</b> <code>summarizer</code> function for logistic regression</a></li>
<li class="chapter" data-level="9.11" data-path="adjusting-for-multiple-variables-in-r.html"><a href="adjusting-for-multiple-variables-in-r.html"><i class="fa fa-check"></i><b>9.11</b> Adjusting for multiple variables in R</a><ul>
<li class="chapter" data-level="9.11.1" data-path="adjusting-for-multiple-variables-in-r.html"><a href="adjusting-for-multiple-variables-in-r.html#worked-example-2"><i class="fa fa-check"></i><b>9.11.1</b> Worked Example</a></li>
<li class="chapter" data-level="9.11.2" data-path="adjusting-for-multiple-variables-in-r.html"><a href="adjusting-for-multiple-variables-in-r.html#exercise-45"><i class="fa fa-check"></i><b>9.11.2</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="9.12" data-path="advanced-fitting-the-best-model.html"><a href="advanced-fitting-the-best-model.html"><i class="fa fa-check"></i><b>9.12</b> Advanced: Fitting the best model</a><ul>
<li class="chapter" data-level="9.12.1" data-path="advanced-fitting-the-best-model.html"><a href="advanced-fitting-the-best-model.html#extra-material-diagnostics-plots"><i class="fa fa-check"></i><b>9.12.1</b> Extra material: Diagnostics plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="time-to-event-data-survival.html"><a href="time-to-event-data-survival.html"><i class="fa fa-check"></i><b>10</b> Time-to-event data (survival)</a><ul>
<li class="chapter" data-level="10.1" data-path="data-5.html"><a href="data-5.html"><i class="fa fa-check"></i><b>10.1</b> Data</a></li>
<li class="chapter" data-level="10.2" data-path="kaplan-meier-survival-estimator.html"><a href="kaplan-meier-survival-estimator.html"><i class="fa fa-check"></i><b>10.2</b> Kaplan-Meier survival estimator</a><ul>
<li class="chapter" data-level="10.2.1" data-path="kaplan-meier-survival-estimator.html"><a href="kaplan-meier-survival-estimator.html#km-analysis-for-whole-cohort"><i class="fa fa-check"></i><b>10.2.1</b> KM analysis for whole cohort</a></li>
<li class="chapter" data-level="10.2.2" data-path="kaplan-meier-survival-estimator.html"><a href="kaplan-meier-survival-estimator.html#model"><i class="fa fa-check"></i><b>10.2.2</b> Model</a></li>
<li class="chapter" data-level="10.2.3" data-path="kaplan-meier-survival-estimator.html"><a href="kaplan-meier-survival-estimator.html#life-table"><i class="fa fa-check"></i><b>10.2.3</b> Life table</a></li>
<li class="chapter" data-level="10.2.4" data-path="kaplan-meier-survival-estimator.html"><a href="kaplan-meier-survival-estimator.html#km-plot"><i class="fa fa-check"></i><b>10.2.4</b> KM plot</a></li>
<li class="chapter" data-level="10.2.5" data-path="kaplan-meier-survival-estimator.html"><a href="kaplan-meier-survival-estimator.html#exercise-46"><i class="fa fa-check"></i><b>10.2.5</b> Exercise</a></li>
<li class="chapter" data-level="10.2.6" data-path="kaplan-meier-survival-estimator.html"><a href="kaplan-meier-survival-estimator.html#log-rank-test"><i class="fa fa-check"></i><b>10.2.6</b> Log-rank test</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="cox-proportional-hazard-regression.html"><a href="cox-proportional-hazard-regression.html"><i class="fa fa-check"></i><b>10.3</b> Cox proportional hazard regression</a><ul>
<li class="chapter" data-level="10.3.1" data-path="cox-proportional-hazard-regression.html"><a href="cox-proportional-hazard-regression.html#model-1"><i class="fa fa-check"></i><b>10.3.1</b> Model</a></li>
<li class="chapter" data-level="10.3.2" data-path="cox-proportional-hazard-regression.html"><a href="cox-proportional-hazard-regression.html#assumptions"><i class="fa fa-check"></i><b>10.3.2</b> Assumptions</a></li>
<li class="chapter" data-level="10.3.3" data-path="cox-proportional-hazard-regression.html"><a href="cox-proportional-hazard-regression.html#exercise-47"><i class="fa fa-check"></i><b>10.3.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="dates-in-r.html"><a href="dates-in-r.html"><i class="fa fa-check"></i><b>10.4</b> Dates in R</a><ul>
<li class="chapter" data-level="10.4.1" data-path="dates-in-r.html"><a href="dates-in-r.html#converting-dates-to-survival-time"><i class="fa fa-check"></i><b>10.4.1</b> Converting dates to survival time</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="solutions-5.html"><a href="solutions-5.html"><i class="fa fa-check"></i><b>10.5</b> Solutions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HealthyR: R for healthcare data analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-linear-regression" class="section level2">
<h2><span class="header-section-number">7.5</span> Multiple linear regression</h2>
<p>Multiple linear regression includes more than one predictor variable. There are a few ways to include more variables, depending on whether they should share the intercept and how they interact:</p>
<p>Simple linear regression (exactly one predictor variable):</p>
<p><code>myfit = lm(lifeExp~year, data=eurodata)</code></p>
<p>Multiple linear regression (additive):</p>
<p><code>myfit = lm(lifeExp~year+country, data=eurodata)</code></p>
<p>Multiple linear regression (all interactions):</p>
<p><code>myfit = lm(lifeExp~year*country, data=eurodata)</code></p>
<p>Multiple linear regression (some interactions):</p>
<p><code>myfit = lm(lifeExp~year:country, data=eurodata)</code></p>
<p>These examples of multiple regression include two variables: <code>year</code> and <code>country</code>, but we could include more by just adding them with <code>+</code>.</p>
<div id="exercise-38" class="section level3">
<h3><span class="header-section-number">7.5.1</span> Exercise</h3>
<p>Open the second Shiny app (“Multiple regression”) and see how:</p>
<ul>
<li>In simple regression, there is only one intercept and slope for the whole dataset.</li>
<li>Using the additive model (<code>lm(formula = y ~ x + group</code>) the two lines (one for each group) have different intercepts but the same slope. However, the <code>lm()</code> summary seems to only include one line called “(Intercept)”, how to find the intercept for the second group of points?</li>
<li>Using the interactive model (<code>lm(formula = y ~ x*group</code>)) the two lines have different intercepts and different slopes.</li>
</ul>
</div>
<div id="exercise-39" class="section level3">
<h3><span class="header-section-number">7.5.2</span> Exercise</h3>
<p>Convince yourself that using an fully interactive multivariable model is the same as running several separate simple linear regression models. Remember that we calculate the life expectancy in 1952 (intercept) and improvement per year (slope) for Turkey and the United Kingdom:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_uk <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">estimate =</span> <span class="kw">round</span>(estimate, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(term, estimate)</code></pre></div>
<pre><code>##            term estimate
## 1   (Intercept)    68.81
## 2 year_from1952     0.19</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit_turkey <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">estimate =</span> <span class="kw">round</span>(estimate, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(term, estimate)</code></pre></div>
<pre><code>##            term estimate
## 1   (Intercept)    46.02
## 2 year_from1952     0.50</code></pre>
<p>(The lines <code>tidy()</code>, <code>mutate()</code>, and <code>select()</code> are only included for neater presentation here, you can use <code>summary()</code> instead.)</p>
<p>We can do this together using <code>year_from1952*country</code> in the <code>lm()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(country <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Turkey&quot;</span>, <span class="st">&quot;United Kingdom&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">lm</span>(lifeExp <span class="op">~</span><span class="st"> </span>year_from1952<span class="op">*</span>country, <span class="dt">data =</span> .)   <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">estimate =</span> <span class="kw">round</span>(estimate, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(term, estimate)</code></pre></div>
<pre><code>##                                  term estimate
## 1                         (Intercept)    46.02
## 2                       year_from1952     0.50
## 3               countryUnited Kingdom    22.79
## 4 year_from1952:countryUnited Kingdom    -0.31</code></pre>
<p>Now. It may seem like R has omitted Turkey but the values for Turkey are actually in the Intercept = 46.02 and in year_from1952 = 0.50. Can you make out the intercept and slope for the UK? Are they the same as in the simple linear regression model?</p>
</div>
<div id="exercise-40" class="section level3">
<h3><span class="header-section-number">7.5.3</span> Exercise</h3>
<p>Add a third country (e.g. “Portugal”) to <code>filter(country %in% c(&quot;Turkey&quot;, &quot;United Kingdom&quot;))</code> in the above example. Do the results change?</p>
</div>
<div id="optional-advanced-exercise-1" class="section level3">
<h3><span class="header-section-number">7.5.4</span> Optional (Advanced) Exercise</h3>
<p>Run separate linear regression models for every country in the dataset at the same time and putting it all in two neat dataframes (one for the coefficients, one for the summary statistics):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linfit_coefficients =<span class="st"> </span>mydata <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">do</span>(
    <span class="kw">tidy</span>(
      <span class="kw">lm</span>(lifeExp<span class="op">~</span>year, <span class="dt">data=</span>.)
    )
  )


linfit_overall =<span class="st"> </span>mydata <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(country) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">do</span>(
    <span class="kw">glance</span>(
      <span class="kw">lm</span>(lifeExp<span class="op">~</span>year, <span class="dt">data=</span>.)
    )
  )</code></pre></div>
<p>Plot the linear regression estimate (improvement per year between 1952 – 2007), size the points by their r-squared values, and colour the points by continent (hint: you will have to join <code>mydata</code>, <code>linfit_coefficients %&gt;% filter(term == &quot;year&quot;)</code>, and <code>linfit_overall</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">1952</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">full_join</span>(linfit_coefficients <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(term <span class="op">==</span><span class="st"> &quot;year&quot;</span>), <span class="dt">by =</span> <span class="st">&quot;country&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">full_join</span>(linfit_overall, <span class="dt">by =</span> <span class="st">&quot;country&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lifeExp, <span class="dt">y =</span> estimate, <span class="dt">colour =</span> continent, <span class="dt">size =</span> r.squared)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Increase in life expectancy per year&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Life expectancy in 1952&quot;</span>)</code></pre></div>
<p><img src="07_linear_regression_files/figure-html/unnamed-chunk-11-1.png" width="432" /></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="if-you-are-new-to-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="very-advanced-example.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/SurgicalInformatics/healthyr_book/edit/master/07_linear_regression.Rmd",
"text": "Edit"
},
"download": ["healthyr-book.pdf", "healthyr-book.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
